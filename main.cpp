#include <iostream>
#include <SciFilter.h>

int main(int, char **)
{
    MatrixXd sos(4, 6);
    sos << 2.13138727e-04, -4.26277454e-04, 2.13138727e-04, 1.00000000e+00, 1.59908181e+00, 7.57867157e-01,
        1.00000000e+00, -2.00000000e+00, 1.00000000e+00, 1.00000000e+00, 1.71742882e+00, 8.10236696e-01,
        1.00000000e+00, 2.00000000e+00, 1.00000000e+00, 1.00000000e+00, 1.63790142e+00, 8.78904341e-01,
        1.00000000e+00, 2.00000000e+00, 1.00000000e+00, 1.00000000e+00, 1.86376749e+00, 9.32707241e-01;
    VectorXd data(800);
    data << 1.22070312e-04,  3.05175781e-05,  0.00000000e+00,  0.00000000e+00,
        6.10351562e-05,  6.10351562e-05,  0.00000000e+00,  0.00000000e+00,
        6.10351562e-05,  0.00000000e+00,  6.10351562e-05, -6.10351562e-05,
       -9.15527344e-05, -3.05175781e-05, -6.10351562e-05, -6.10351562e-05,
       -1.22070312e-04, -3.05175781e-05, -6.10351562e-05, -1.83105469e-04,
       -1.22070312e-04, -9.15527344e-05, -6.10351562e-05, -6.10351562e-05,
       -6.10351562e-05, -3.05175781e-05, -3.05175781e-05, -9.15527344e-05,
       -1.22070312e-04, -9.15527344e-05, -1.22070312e-04, -1.52587891e-04,
       -1.52587891e-04, -6.10351562e-05, -1.22070312e-04, -1.83105469e-04,
       -1.52587891e-04, -1.22070312e-04, -1.52587891e-04, -1.52587891e-04,
       -6.10351562e-05, -2.13623047e-04, -9.15527344e-05, -1.22070312e-04,
       -1.83105469e-04, -6.10351562e-05, -9.15527344e-05, -1.22070312e-04,
       -2.13623047e-04, -3.05175781e-05, -9.15527344e-05, -1.22070312e-04,
       -1.22070312e-04, -2.13623047e-04, -2.13623047e-04, -1.83105469e-04,
       -9.15527344e-05, -2.44140625e-04, -2.13623047e-04, -1.83105469e-04,
       -2.13623047e-04, -1.83105469e-04, -1.52587891e-04, -1.52587891e-04,
       -2.13623047e-04, -2.44140625e-04, -1.83105469e-04, -1.83105469e-04,
       -2.74658203e-04, -2.74658203e-04, -2.13623047e-04, -2.44140625e-04,
       -2.44140625e-04, -2.44140625e-04, -2.74658203e-04, -2.44140625e-04,
       -2.44140625e-04, -2.13623047e-04, -2.44140625e-04, -1.83105469e-04,
       -1.83105469e-04, -1.52587891e-04, -9.15527344e-05, -2.13623047e-04,
       -1.83105469e-04, -2.13623047e-04, -1.83105469e-04, -9.15527344e-05,
       -1.52587891e-04, -1.83105469e-04, -1.83105469e-04, -1.22070312e-04,
       -9.15527344e-05, -1.83105469e-04, -1.83105469e-04, -1.22070312e-04,
       -1.83105469e-04, -2.13623047e-04, -1.83105469e-04, -1.22070312e-04,
       -1.22070312e-04, -1.83105469e-04, -1.52587891e-04, -1.52587891e-04,
       -1.52587891e-04, -2.44140625e-04, -1.83105469e-04, -2.13623047e-04,
       -1.83105469e-04, -1.22070312e-04, -1.52587891e-04, -1.83105469e-04,
       -1.83105469e-04, -1.52587891e-04, -1.83105469e-04, -9.15527344e-05,
       -1.22070312e-04, -9.15527344e-05, -9.15527344e-05, -1.22070312e-04,
       -1.22070312e-04, -2.13623047e-04, -1.22070312e-04, -2.13623047e-04,
       -2.44140625e-04, -1.83105469e-04, -1.52587891e-04, -2.44140625e-04,
       -2.74658203e-04, -1.83105469e-04, -1.83105469e-04, -2.13623047e-04,
       -2.74658203e-04, -1.83105469e-04, -2.74658203e-04, -3.05175781e-04,
       -2.13623047e-04, -2.44140625e-04, -2.44140625e-04, -2.13623047e-04,
       -1.83105469e-04, -2.13623047e-04, -2.13623047e-04, -9.15527344e-05,
       -1.22070312e-04, -1.52587891e-04, -1.22070312e-04, -1.52587891e-04,
       -2.13623047e-04, -2.13623047e-04, -1.22070312e-04, -1.83105469e-04,
       -2.13623047e-04, -1.52587891e-04, -1.22070312e-04, -1.83105469e-04,
       -1.83105469e-04, -9.15527344e-05, -1.22070312e-04, -1.52587891e-04,
       -1.52587891e-04,  0.00000000e+00, -1.22070312e-04, -1.83105469e-04,
       -6.10351562e-05, -1.52587891e-04, -6.10351562e-05, -9.15527344e-05,
       -1.22070312e-04, -1.22070312e-04, -9.15527344e-05, -6.10351562e-05,
       -1.52587891e-04, -1.22070312e-04, -1.22070312e-04, -9.15527344e-05,
       -9.15527344e-05, -9.15527344e-05, -1.52587891e-04, -1.52587891e-04,
       -9.15527344e-05, -1.22070312e-04, -1.22070312e-04, -1.83105469e-04,
       -1.83105469e-04, -1.83105469e-04, -1.52587891e-04, -1.83105469e-04,
       -2.13623047e-04, -1.83105469e-04, -1.52587891e-04, -1.83105469e-04,
       -1.83105469e-04, -2.74658203e-04, -2.44140625e-04, -1.22070312e-04,
       -1.52587891e-04, -1.83105469e-04, -1.52587891e-04, -1.22070312e-04,
       -1.22070312e-04, -1.52587891e-04, -6.10351562e-05,  0.00000000e+00,
       -1.52587891e-04, -9.15527344e-05, -6.10351562e-05, -6.10351562e-05,
       -1.52587891e-04, -1.83105469e-04, -1.22070312e-04, -2.13623047e-04,
       -1.83105469e-04, -1.83105469e-04, -2.44140625e-04, -3.05175781e-04,
       -1.83105469e-04, -1.52587891e-04, -2.44140625e-04, -2.13623047e-04,
       -2.13623047e-04, -1.83105469e-04, -2.13623047e-04, -2.13623047e-04,
       -2.44140625e-04, -2.13623047e-04, -1.22070312e-04, -1.83105469e-04,
       -1.83105469e-04, -2.44140625e-04, -1.83105469e-04, -2.74658203e-04,
       -1.83105469e-04, -1.22070312e-04, -3.35693359e-04, -2.13623047e-04,
       -4.27246094e-04, -6.10351562e-05, -5.49316406e-04, -6.10351562e-05,
       -4.27246094e-04, -2.74658203e-04, -9.15527344e-05, -7.62939453e-04,
        5.18798828e-04, -1.22070312e-03,  6.71386719e-04, -1.03759766e-03,
        9.15527344e-05,  0.00000000e+00, -1.25122070e-03,  1.28173828e-03,
       -2.41088867e-03,  1.95312500e-03, -2.34985352e-03,  1.03759766e-03,
       -5.49316406e-04, -1.31225586e-03,  2.16674805e-03, -3.69262695e-03,
        3.87573242e-03, -4.36401367e-03,  3.02124023e-03, -2.01416016e-03,
       -5.79833984e-04,  2.31933594e-03, -4.82177734e-03,  5.79833984e-03,
       -6.83593750e-03,  5.82885742e-03, -4.45556641e-03,  1.37329102e-03,
        1.37329102e-03, -4.94384766e-03,  7.23266602e-03, -9.21630859e-03,
        8.72802734e-03, -7.56835938e-03,  4.24194336e-03, -7.62939453e-04,
       -4.02832031e-03,  7.29370117e-03, -1.05895996e-02,  1.09558105e-02,
       -1.06201172e-02,  7.26318359e-03, -3.69262695e-03, -1.98364258e-03,
        6.10351562e-03, -1.04980469e-02,  1.19323730e-02, -1.25732422e-02,
        9.82666016e-03, -6.43920898e-03,  7.62939453e-04,  3.93676758e-03,
       -9.09423828e-03,  1.15356445e-02, -1.31225586e-02,  1.11694336e-02,
       -8.42285156e-03,  3.23486328e-03,  1.49536133e-03, -6.98852539e-03,
        1.00402832e-02, -1.22375488e-02,  1.13525391e-02, -9.30786133e-03,
        4.85229492e-03, -4.27246094e-04, -4.51660156e-03,  7.99560547e-03,
       -1.05590820e-02,  1.03454590e-02, -9.12475586e-03,  5.58471680e-03,
       -1.92260742e-03, -2.59399414e-03,  5.79833984e-03, -8.36181641e-03,
        8.69750977e-03, -8.08715820e-03,  5.49316406e-03, -2.68554688e-03,
       -1.06811523e-03,  3.75366211e-03, -6.10351562e-03,  6.65283203e-03,
       -6.65283203e-03,  4.76074219e-03, -2.77709961e-03, -3.05175781e-05,
        1.95312500e-03, -4.08935547e-03,  4.54711914e-03, -4.79125977e-03,
        3.60107422e-03, -2.41088867e-03,  4.57763672e-04,  9.15527344e-04,
       -2.28881836e-03,  2.65502930e-03, -2.86865234e-03,  2.13623047e-03,
       -1.55639648e-03,  3.96728516e-04,  4.57763672e-04, -1.12915039e-03,
        1.19018555e-03, -1.28173828e-03,  7.93457031e-04, -3.35693359e-04,
       -2.13623047e-04,  5.18798828e-04, -7.01904297e-04,  4.88281250e-04,
       -2.74658203e-04, -3.35693359e-04,  6.40869141e-04, -1.03759766e-03,
        1.00708008e-03, -9.46044922e-04,  3.35693359e-04,  9.15527344e-05,
       -8.54492188e-04,  1.25122070e-03, -1.58691406e-03,  1.40380859e-03,
       -1.25122070e-03,  7.32421875e-04, -9.15527344e-05, -7.01904297e-04,
        1.15966797e-03, -1.55639648e-03,  1.64794922e-03, -1.55639648e-03,
        1.00708008e-03, -5.49316406e-04, -1.52587891e-04,  7.32421875e-04,
       -1.12915039e-03,  1.40380859e-03, -1.43432617e-03,  1.22070312e-03,
       -8.23974609e-04,  3.96728516e-04,  1.83105469e-04, -6.40869141e-04,
        9.46044922e-04, -9.46044922e-04,  1.00708008e-03, -7.62939453e-04,
        6.10351562e-04, -2.44140625e-04, -1.52587891e-04,  3.96728516e-04,
       -5.79833984e-04,  5.49316406e-04, -6.10351562e-04,  3.96728516e-04,
       -3.35693359e-04,  6.10351562e-05,  6.10351562e-05, -1.52587891e-04,
        2.74658203e-04, -2.74658203e-04,  1.83105469e-04, -9.15527344e-05,
        3.05175781e-05,  0.00000000e+00,  0.00000000e+00,  3.05175781e-05,
        1.22070312e-04, -3.05175781e-05,  6.10351562e-05, -6.10351562e-05,
        6.10351562e-05,  0.00000000e+00,  0.00000000e+00,  1.83105469e-04,
       -1.52587891e-04,  2.13623047e-04, -1.83105469e-04,  1.83105469e-04,
       -1.22070312e-04, -3.05175781e-05,  9.15527344e-05, -9.15527344e-05,
        2.74658203e-04, -2.13623047e-04,  3.05175781e-04, -1.83105469e-04,
        2.74658203e-04, -3.05175781e-05, -3.05175781e-05,  1.83105469e-04,
       -3.05175781e-04,  3.35693359e-04, -3.35693359e-04,  3.05175781e-04,
       -1.83105469e-04,  1.52587891e-04,  1.22070312e-04, -1.83105469e-04,
        3.66210938e-04, -3.35693359e-04,  4.57763672e-04, -3.96728516e-04,
        3.05175781e-04,  0.00000000e+00, -3.05175781e-05,  2.44140625e-04,
       -3.35693359e-04,  5.49316406e-04, -4.57763672e-04,  4.57763672e-04,
       -2.44140625e-04,  1.52587891e-04,  1.52587891e-04, -3.05175781e-04,
        4.57763672e-04, -5.18798828e-04,  4.88281250e-04, -4.88281250e-04,
        2.13623047e-04, -9.15527344e-05, -1.83105469e-04,  3.66210938e-04,
       -5.18798828e-04,  5.18798828e-04, -4.88281250e-04,  3.35693359e-04,
       -1.83105469e-04,  3.05175781e-05,  3.35693359e-04, -3.96728516e-04,
        4.88281250e-04, -4.27246094e-04,  4.27246094e-04, -2.13623047e-04,
        6.10351562e-05,  3.05175781e-05, -2.74658203e-04,  3.35693359e-04,
       -4.57763672e-04,  2.74658203e-04, -3.96728516e-04,  1.52587891e-04,
       -9.15527344e-05, -2.13623047e-04,  1.22070312e-04, -3.66210938e-04,
        2.13623047e-04, -3.96728516e-04,  1.22070312e-04, -1.83105469e-04,
       -1.22070312e-04,  0.00000000e+00, -2.74658203e-04,  9.15527344e-05,
       -3.66210938e-04,  0.00000000e+00, -2.44140625e-04, -1.83105469e-04,
       -1.52587891e-04, -2.44140625e-04, -3.05175781e-05, -3.96728516e-04,
       -1.22070312e-04, -2.44140625e-04, -1.52587891e-04, -1.83105469e-04,
       -2.44140625e-04, -1.52587891e-04, -3.05175781e-04, -1.22070312e-04,
       -2.44140625e-04, -1.52587891e-04, -1.83105469e-04, -2.44140625e-04,
       -1.22070312e-04, -2.44140625e-04, -1.22070312e-04, -1.22070312e-04,
       -1.52587891e-04, -1.22070312e-04, -2.13623047e-04, -1.22070312e-04,
       -2.13623047e-04, -1.52587891e-04, -2.44140625e-04, -2.13623047e-04,
       -1.22070312e-04, -2.13623047e-04, -6.10351562e-05, -2.74658203e-04,
       -2.44140625e-04, -2.44140625e-04, -2.74658203e-04, -3.05175781e-04,
       -3.05175781e-04, -2.44140625e-04, -2.74658203e-04, -2.74658203e-04,
       -3.66210938e-04, -2.44140625e-04, -2.44140625e-04, -3.05175781e-04,
       -3.05175781e-04, -3.35693359e-04, -2.13623047e-04, -2.44140625e-04,
       -3.35693359e-04, -3.05175781e-04, -2.44140625e-04, -2.74658203e-04,
       -2.13623047e-04, -1.83105469e-04, -1.52587891e-04, -1.22070312e-04,
       -1.83105469e-04, -2.13623047e-04, -2.13623047e-04, -2.44140625e-04,
       -2.74658203e-04, -2.13623047e-04, -2.44140625e-04, -1.83105469e-04,
       -2.44140625e-04, -2.13623047e-04, -1.22070312e-04, -2.44140625e-04,
       -2.13623047e-04, -1.22070312e-04, -1.22070312e-04, -1.22070312e-04,
       -1.83105469e-04, -2.13623047e-04, -9.15527344e-05, -9.15527344e-05,
       -1.52587891e-04, -2.13623047e-04, -1.22070312e-04, -6.10351562e-05,
       -2.13623047e-04, -2.74658203e-04, -1.83105469e-04, -6.10351562e-05,
       -1.22070312e-04, -1.52587891e-04, -1.22070312e-04, -1.22070312e-04,
       -9.15527344e-05, -1.22070312e-04, -9.15527344e-05, -1.22070312e-04,
       -1.83105469e-04, -6.10351562e-05, -1.52587891e-04, -1.83105469e-04,
       -1.83105469e-04, -1.22070312e-04, -1.22070312e-04, -2.13623047e-04,
       -1.22070312e-04, -9.15527344e-05, -1.52587891e-04, -6.10351562e-05,
       -6.10351562e-05, -2.13623047e-04, -1.22070312e-04, -9.15527344e-05,
       -1.52587891e-04, -1.83105469e-04, -3.05175781e-05, -3.05175781e-05,
       -1.22070312e-04, -3.05175781e-05,  0.00000000e+00, -6.10351562e-05,
       -1.22070312e-04, -6.10351562e-05, -9.15527344e-05, -6.10351562e-05,
       -1.83105469e-04, -1.52587891e-04,  0.00000000e+00, -9.15527344e-05,
       -1.83105469e-04, -2.74658203e-04, -9.15527344e-05, -1.83105469e-04,
       -1.83105469e-04, -2.44140625e-04, -2.74658203e-04, -1.22070312e-04,
       -2.44140625e-04, -2.74658203e-04, -2.44140625e-04, -1.83105469e-04,
       -2.13623047e-04, -2.74658203e-04, -2.74658203e-04, -2.13623047e-04,
       -2.74658203e-04, -2.74658203e-04, -2.74658203e-04, -2.13623047e-04,
       -2.44140625e-04, -3.05175781e-04, -2.44140625e-04, -2.44140625e-04,
       -1.83105469e-04, -2.13623047e-04, -1.52587891e-04, -1.83105469e-04,
       -2.13623047e-04, -9.15527344e-05, -9.15527344e-05, -9.15527344e-05,
       -9.15527344e-05, -6.10351562e-05, -6.10351562e-05, -6.10351562e-05,
       -6.10351562e-05, -9.15527344e-05, -1.22070312e-04, -1.22070312e-04,
       -3.05175781e-05, -1.22070312e-04, -9.15527344e-05, -1.83105469e-04,
       -1.22070312e-04, -3.05175781e-05, -1.52587891e-04, -6.10351562e-05,
       -1.22070312e-04, -6.10351562e-05, -1.83105469e-04, -1.83105469e-04,
       -6.10351562e-05, -1.83105469e-04, -6.10351562e-05, -1.22070312e-04,
        0.00000000e+00, -1.52587891e-04, -2.13623047e-04, -6.10351562e-05,
       -1.83105469e-04,  0.00000000e+00, -1.22070312e-04, -3.05175781e-05,
       -6.10351562e-05, -9.15527344e-05,  0.00000000e+00, -9.15527344e-05,
        9.15527344e-05, -1.22070312e-04,  3.05175781e-05, -9.15527344e-05,
       -6.10351562e-05,  6.10351562e-05, -1.83105469e-04,  6.10351562e-05,
       -1.52587891e-04,  9.15527344e-05, -6.10351562e-05, -3.05175781e-05,
        6.10351562e-05, -1.52587891e-04,  1.52587891e-04, -2.74658203e-04,
        1.52587891e-04, -9.15527344e-05,  0.00000000e+00,  9.15527344e-05,
       -1.22070312e-04,  2.74658203e-04, -3.05175781e-04,  2.44140625e-04,
       -9.15527344e-05,  1.52587891e-04,  6.10351562e-05, -1.52587891e-04,
        2.74658203e-04, -2.74658203e-04,  3.05175781e-04, -1.83105469e-04,
        2.74658203e-04,  9.15527344e-05, -6.10351562e-05,  3.35693359e-04,
       -1.83105469e-04,  4.27246094e-04, -2.13623047e-04,  2.13623047e-04,
        1.52587891e-04,  9.15527344e-05,  2.44140625e-04, -1.52587891e-04,
        5.49316406e-04, -3.05175781e-05,  3.66210938e-04,  0.00000000e+00,
        1.22070312e-04,  3.66210938e-04, -2.13623047e-04,  5.18798828e-04,
       -1.22070312e-04,  5.79833984e-04,  3.05175781e-05,  1.22070312e-04,
        3.66210938e-04, -1.83105469e-04,  5.49316406e-04, -3.05175781e-04,
        5.79833984e-04, -6.10351562e-05,  3.05175781e-04,  3.66210938e-04,
       -9.15527344e-05,  7.01904297e-04, -3.66210938e-04,  7.62939453e-04,
       -1.83105469e-04,  3.96728516e-04,  2.13623047e-04, -3.05175781e-05,
        6.10351562e-04, -4.57763672e-04,  7.62939453e-04, -3.35693359e-04,
        5.49316406e-04,  3.05175781e-05,  9.15527344e-05,  4.57763672e-04,
       -3.66210938e-04,  7.62939453e-04, -4.27246094e-04,  5.49316406e-04,
       -1.52587891e-04,  1.83105469e-04,  2.44140625e-04, -2.74658203e-04,
        4.57763672e-04, -3.35693359e-04,  4.88281250e-04, -1.52587891e-04,
        2.13623047e-04,  6.10351562e-05, -9.15527344e-05,  2.44140625e-04,
       -1.52587891e-04,  1.83105469e-04, -6.10351562e-05,  9.15527344e-05,
        9.15527344e-05, -3.05175781e-05,  1.52587891e-04,  0.00000000e+00;
    VectorXd res = SciFilter::sosfiltfilt(sos, data);
    std::cout << res << std::endl;
}
